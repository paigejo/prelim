\documentclass{uwstat572}

%%\setlength{\oddsidemargin}{0.25in}
%%\setlength{\textwidth}{6in}
%%\setlength{\topmargin}{0.5in}
%%\setlength{\textheight}{9in}

\renewcommand{\baselinestretch}{1.5} 
\usepackage{/Users/paigejo/mystyle}

\bibliographystyle{plainnat}

\begin{document}
%%\maketitle

\begin{center}
  {\LARGE Geostatistical inference under preferential sampling: background and motivation}\\\ \\
  {John Paige \\ 
    Department of Statistics, University of Washington Seattle, WA, 98195, USA
  }
\end{center}

As discussed in \citet{diggle2010}, geostatistics considers stochastic processes varying in space.  In some applications the process, $S$, might be measured at a set of discrete locations, say $X = \set{x_1, x_2, ..., x_n}$ (often a subset of $\mathbb{R}^2$, as in \citet{diggle2010}).  In others, $S$ might be measured as a set of averages or a quantile function over different regions.  Here, we consider the following model for measured observations, $Y_i \in \mathbb{R}$, of the spatial process:
\begin{equation}
Y_i = \mu + S(x_i) + Z_i,
\label{model}
\end{equation}
where $i \in \set{1, ..., n}$, $\mu$ is the mean of measured process, and the $Z_i \iid \Norm{0, \tau^2}$ can be interpretted as independent fine-scale measurement errors.  Note that in the above model we assume $E\brack{S} = 0$, which is why $\mu$, the overall mean of the spatial process, is included, and that $S(X) = \set{S(x_1, ..., S(x_n)}$ is multivariate normal with $\cov{S(x), S(x')}$ as a function of $|x - x'|$.  Note that assuming a constant mean is not restrictive, since we can model $\mu$ as a function in space using a generalized linear regression framework, letting $E[Y_i] = \mu_i = \v{X}_i' \v{\beta}$, where errors are correlated due to spatial correlations in $S$.
\\\\
Correlations in $S$ are modelled under the assumption of stationarity and isotropy in the case of \citet{diggle2010}.  Stationarity in combination with isotropy means that, in addition to the form of the covariance in values of $S$ being a function of distance alone, the variance of the spatial process becomes
\begin{equation}
\var{S(x) - S(x')} = \sigma^2 - \sigma^2 \rho(|x - x'| \ \vert \v{\theta})
\label{variogram}
\end{equation}
where $\rho(\cdot  \vert \v{\theta})$ is a positive definite correlation function depending on parameters $\v{\theta}$ that is a function of distance.  The variance in Eq. (\ref{variogram}) is sometimes called a variogram when viewed as a function of distance.  \citet{diggle2010} uses the Mat\'{e}rn correlation function,
$$ \rho(u \ \vert \ \phi, \kappa) = \frac{1}{2^{\kappa - 1} \Gamma(\kappa)} (u/\phi)^{\kappa} K_\kappa(u/\phi), $$
where $\kappa > 0$ is called a smoothness parameter, $\phi > 0$ is the spatial scale parameter, and $K_\kappa(\cdot)$ is the modified Bessel function of the second kind of order $\kappa$.  As noted in \citet{diggle2010}, the Mat\'{e}rn class of covariance functions is very flexible, containing exponential correlation as a special case when $\kappa = 0.5$, and is commonly used in geostatistics.  One difficulty using a Mat\'{e}rn covariance model is that $\phi$ and $\kappa$ are sometimes difficult to estimate jointly, especially $\kappa$ \citep{diggle2010}.
\\\\
There are several advantages to modeling the variogram in a spatial model.  It provides a simple interpretation relating to correlations and variance in $S$ over space as a function of distance.  In addition, it is easy to estimate assuming stationarity and under certain distributional assumptions of the sample locations.  A point cloud method of estimating empirical variogram works by plotting the distance between observations $y_i$ and $y_j$ versus $(y_i - y_j)^2/2$, the method of moments estimator for the variance based on two observations assuming the $y_i$ have zero expectation \citep{diggle2010}.  If the $y_i$ are not mean zero, we can simply subtract off $\mu$ from Eq. (\ref{model}).  Additionally, we could partition the possible distances between observations into sufficiently fine bins, and estimate the variance between differences of observations with distances in each bin.  Of course, if the bins are too fine, then our estimates of the variogram within each bin would be poor.  More advanced methods for estimating variograms are given in \citet[section 2.2]{chiles1999}, \citet{cressie1985}, and \citet[section 2.4]{cressie1991}.
\\\\
In classical geostatistical analysis, it is assumed that the observation locations are independent of the mesaured spatial field \citep{diggle2010}.  However, in the case of certain datasets, this might not be the case.  Consider a tornado chaser trying to measure the wind speed of the tornado.  It would be a terrible idea to try to infer average wind speeds in a region from the tornado chaser's wind speed data.  This is because the data they collect is much more likely to be in locations and times where the wind speeds are abnormally high.  This is what \citet{diggle2010} refers to as \emph{preferential sampling}, and is the focus of their paper.  Sometimes, as in the dataset used in \citet{diggle2010}, it is not clear whether a dataset has been sampled preferentially or not.  The dataset in \citet{diggle2010} contains lead concentration data in Gallicia, in northern Spain, from two years: 1997 and 2000.  The 1997 the sampling locations are primarily concentrated in the north of Gallicia, whereas in 2000, the locations are on a relatively evenly spaced grid.  The authors of \cite{diggle2010} then try to determine the extent of the preferential sampling that may have occured in 1997, how to account for it, and also how it might affect the results of a `naive' geostatistical analysis that does not take preferentiality into account.
\\\\
In order to account for preferential sampling, \citet{isaaks1988} and \citet{srivastava1989} proposed a non-ergodic variogram estimator as an alternative to classical estimators that they claimed were more robust to nonstationary and preferential data.  However, \citet{curriero2002} found that the non-ergodic estimators `possess no clear advantage' over the traditional estimators, and in fact performed worse in the cases they studied.  \citet{schlather2004} note that if $S$ is stationary, then $M_k(h) \defn E[S(x)^k \vert x, x+h \in X]$ is constant if the sampling process is non-preferential, since the expectation does not depend on $x+h$.  \citet{schlather2004} then defines tests for preferentiality (assuming that $S$ is stationary) based on $M_1(h)$ and $M_2(h)$ using simulations under models assuming non-preferentiality.
\\\\
In addition to analyzing variations in observation \emph{values} over space, it is common to study the patterns in the observation \emph{locations}, as in \citet{diggle2010}.  Point processes are stochastic processes used to model random distributions of countably many points throughout a spatial domain (here we assume a bounded subset of $\mathbb{R}^2$) \citep{handbook}.  Common models for point processes include homogeneous or inhomogeneous Poisson processes, Cox processes, Markov point processes, and others \citep{handbook}.  A homogeneous Poisson process with rate (intensity) $\lambda > 0$ is a point process such that for bounded Borel sets $B, B' \subset \mathbb{R}^2$ the following conditions are satisfied:
\begin{enumerate}
\item the number of points in a bounded Borel set, $B$, is a random variable given by $N(B)~\sim~\Pois{\lambda \mu(B)} $, where $\mu$ is the Lebesgue measure, and
\item $N(B) \indep N(B')$ when $B \cap B' = \emptyset$
\end{enumerate}
An inhomogeneous Poisson process is the same, except it has a rate $\lambda(x)$ that varies is space so that 
$$ N(B) \sim \Pois{\int_B \lambda(x) \ dx} $$
A Cox process \citep{cox1955} (also known as a doubly stochastic Poisson process) is a generalization of inhomogeneous Poisson processes with the following properties:
\begin{enumerate}
\item Random rate $\Lambda = \set{\Lambda(x) : x \in \mathbb{R}^2}$ is a nonnegative stochastic process, and
\item In any fixed realization, $\Lambda(x) = \lambda(x) : x \in \mathbb{R}^2$, the point process is an inhomogeneous Poisson process with rate $\lambda(x) \geq 0$.
\end{enumerate}
In the case where
\begin{equation}
\Lambda(x) = \exp{\alpha + \beta S(x)},
\label{lGCP}
\end{equation}
where $S(x)$ is the stochastic Gaussian process defined in Eq. (\ref{model}), the resulting point process is known as a log-Gaussian Cox process (lGCP) \citep{diggle2010}.
\\\\
Just as the variogram can measure the level of correlation in observation values through space, the $K$-function can be helpful when analyzing the level of correlation in observation locations.  For instance, we can use the $K$ function in Monte Carlo goodness of fit tests for point process models \citep[Section 18.3]{handbook} and also when determining if the data follows complete spatial randomness (CSR) (\emph{i.e.} if it is consistent with a homogeneous Poisson process model).  $K$ functions can also be used to test whether there is clustering or repulsion among the observation locations.  The $K$-function is defined as $K(s) = \lambda^{-1} E[N_0(s)]$ for homogeneous point processes, where $E[N_0(s)]$ denotes the expected number of points with distance $s$ from another point.  Under CSR, the $K$ function has the form $K(s) = \pi s^2$, but when the empirical $K$ function is above or below $\pi s^2$, the data is indicative of clustering or repulsion respectively.  In the case of lGCPs following Eq. (\ref{lGCP}), the $K$ function has the form:
\begin{equation}
K(s) = \pi s^2 + 2 \pi \int_0^s \gamma(u) u \ du
\label{Kfun}
\end{equation}
where $\gamma(u) = \exp{\beta^2 \sigma^2 \rho(u ; \phi, \kappa)} - 1$ is the covariance of $\Lambda$, $\cov{\Lambda(x), \Lambda(x + u)}$.

%\bibliographystyle{../te}
\bibliography{/Users/paigejo/git/prelim/prelim}

\end{document}









